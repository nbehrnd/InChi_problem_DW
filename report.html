<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-09-20 Mon 16:22 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="norwid" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org44b9517">1. Motivation</a></li>
<li><a href="#orgf8fe330">2. Test run (n = 1k), OpenBabel</a>
<ul>
<li><a href="#orgc6e7dc7">2.1. preparation</a></li>
<li><a href="#org9149d2c">2.2. Conclusion</a></li>
</ul>
</li>
<li><a href="#org76a35eb">3. Test run (n = 5k), OpenBabel</a></li>
<li><a href="#org7934c20">4. Test run, (n = 1k), RDKit</a></li>
<li><a href="#orge6f15a7">5. Test run, (n = 5k), RDKit</a></li>
<li><a href="#orgfa8ad6e">6. Single molecule</a></li>
<li><a href="#orge780ba7">7. Cross-check InChI trust reference</a></li>
<li><a href="#orgc16b2b3">8. Cross-check with the InChI trust reference, b</a></li>
</ul>
</div>
</div>
<div id="outline-container-org44b9517" class="outline-2">
<h2 id="org44b9517"><span class="section-number-2">1.</span> Motivation</h2>
<div class="outline-text-2" id="text-1">
<p>
The disagreement between OpenBabel and RDKit on one hand, and DataWarrior on
the other hand, about the InChiKeys assigned to the structures need not be a
disagreement on the level where these are hashed from the intermediate InChi.
Instead, there already could be differences assigning the InChi.  A previous
run with a set with 250 molecules could be to small to provide a reasonable
picture.
</p>

<p>
Again, the Python interface to OpenBabel (version 3.1.1, as provided in the
repositories of Debian 12/bookworm, branch testing) is used for an inspection.
Scripts used are written for and used from the CLI of standard CPython
(version 3.9.2 as installed from Debian's repositories).
</p>
</div>
</div>

<div id="outline-container-orgf8fe330" class="outline-2">
<h2 id="orgf8fe330"><span class="section-number-2">2.</span> Test run (n = 1k), OpenBabel</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgc6e7dc7" class="outline-3">
<h3 id="orgc6e7dc7"><span class="section-number-3">2.1.</span> preparation</h3>
<div class="outline-text-3" id="text-2-1">
<p>
With DataWarrior's default settings, a random library of 1000 molecules was
generated (file <code>Random_Molecules_1000.dwar</code>).  These were exported directly
into a structure file (file <code>Random_Molecules_1000.sdf</code>).
</p>

<p>
Script <code>obabel_inchi.py</code> was used to read DataWarrior's <code>.sdf</code> to count the
chiral atoms, double bonds unrelated to cycles and to assign SMILES, InChi,
and InChiKeys.  The script wrote file <code>analysis.txt</code> as permanent record with
column headers obstereo, obEZ, obSMILES, obInChi, and obInChiKey
respectively.  To ease interaction with DataWarrior, the tables were
separated by tabulators.
</p>

<p>
The content of file <code>analysis.txt</code> was pasted into a pristine running
instance of DataWarrior including the header line.  DataWarrior macro
<code>ob_dw_check.dwam</code> was imported and run to
</p>
<ul class="org-ul">
<li>assign SMILES, Inchi, and InChiKey by DataWarrior based on OpenBabel's
SMILES</li>
<li>to compare e.g., obSMILES (SMILES by OpenBabel) with dwSMILES (SMILES by
DW) as strings.  The Boolean relation <code>str(obSMILES) =</code> str(dwSMILES)=
either yields <code>1</code> (one) if these strings match each other, or <code>0</code> (zero) if
the strings compared with each other are different.</li>
</ul>
<p>
The results were saved in file <code>Random_Molecules_1000_check.dwar</code>.  The sort
of the entries (e.g., number of stereogenic centers (<code>obstereo</code>) as first,
the number of exocyclic double bonds (<code>obEZ</code>) as second criterion), again
supports the hypothesis of identical InChi assigned by OpenBabel and DW for
all compounds lacking a stereogenic center and an exocyclic double bond.
</p>

<p>
Note the advantage of this .dwar file to narrow down interactively the
molecules of interest with the slide rules (e.g., number of double bonds,
chiral centers, level of the Boolean comparisons).
</p>

<p>
It equally is possible to sort the entries for similarity/dissimilarity of
the SMILES strings (column <code>diff_smiles</code>).  Since the same structure may be
expressed differently (e.g., <code>c1ccncc1</code> and <code>c1ccccn1</code> both about pyridine),
this criterion however is not pursued further.
</p>

<p>
The content of <code>Random_Molecules_1000_check.dwar</code> was exported as text (File
-&gt; Save Special -&gt; Textfile) as file <code>Random_Molecules_1000_check.txt</code>.
Python script <code>table_stat.py</code> was used to group the molecules by number of
stereogenic centers, number of exocyclic double bonds and if the strings of
the InChi assigned by OpenBabel and DW match (<code>1</code>) or not (<code>0</code>).  With file
<code>frequency_List.txt</code>, the script generated a permanent record.
</p>

<p>
This frequency count is the basis for the following table.
</p>

<table id="org090a7f6" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">molecule type</th>
<th scope="col" class="org-right">InChi (match)</th>
<th scope="col" class="org-right">InChi (no match)</th>
<th scope="col" class="org-right">sum</th>
<th scope="col" class="org-right">rel. correct</th>
</tr>

<tr>
<th scope="col" class="org-left">(stereo, EZ)</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">[in percent]</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">0 0</td>
<td class="org-right">341</td>
<td class="org-right">0</td>
<td class="org-right">341</td>
<td class="org-right">100.00</td>
</tr>

<tr>
<td class="org-left">0 1</td>
<td class="org-right">20</td>
<td class="org-right">79</td>
<td class="org-right">99</td>
<td class="org-right">20.20</td>
</tr>

<tr>
<td class="org-left">0 2</td>
<td class="org-right">0</td>
<td class="org-right">38</td>
<td class="org-right">38</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">0 3</td>
<td class="org-right">0</td>
<td class="org-right">6</td>
<td class="org-right">6</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">0 4</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">1 0</td>
<td class="org-right">190</td>
<td class="org-right">15</td>
<td class="org-right">205</td>
<td class="org-right">92.68</td>
</tr>

<tr>
<td class="org-left">1 1</td>
<td class="org-right">12</td>
<td class="org-right">57</td>
<td class="org-right">69</td>
<td class="org-right">17.39</td>
</tr>

<tr>
<td class="org-left">1 2</td>
<td class="org-right">0</td>
<td class="org-right">21</td>
<td class="org-right">21</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">1 3</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">3</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">1 4</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">2 0</td>
<td class="org-right">64</td>
<td class="org-right">32</td>
<td class="org-right">96</td>
<td class="org-right">66.67</td>
</tr>

<tr>
<td class="org-left">2 1</td>
<td class="org-right">3</td>
<td class="org-right">33</td>
<td class="org-right">36</td>
<td class="org-right">8.33</td>
</tr>

<tr>
<td class="org-left">2 2</td>
<td class="org-right">0</td>
<td class="org-right">4</td>
<td class="org-right">4</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">2 3</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">3 0</td>
<td class="org-right">18</td>
<td class="org-right">20</td>
<td class="org-right">38</td>
<td class="org-right">47.37</td>
</tr>

<tr>
<td class="org-left">3 1</td>
<td class="org-right">1</td>
<td class="org-right">8</td>
<td class="org-right">9</td>
<td class="org-right">11.11</td>
</tr>

<tr>
<td class="org-left">3 2</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">4 0</td>
<td class="org-right">6</td>
<td class="org-right">11</td>
<td class="org-right">17</td>
<td class="org-right">35.29</td>
</tr>

<tr>
<td class="org-left">4 1</td>
<td class="org-right">0</td>
<td class="org-right">5</td>
<td class="org-right">5</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">5 0</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">33.33</td>
</tr>

<tr>
<td class="org-left">5 1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">6 1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">7 0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org9149d2c" class="outline-3">
<h3 id="org9149d2c"><span class="section-number-3">2.2.</span> Conclusion</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Except for molecules lacking stereogenic centers and exocyclic double bonds,
apparently, there are differences in the assignment of InChi by current
OpenBabel (version 3.1.1) and DataWarrior (development version for Mac/Linux,
fetched by <span class="timestamp-wrapper"><span class="timestamp">&lt;2021-09-07 Tue&gt;</span></span>).
</p>

<p>
The limited compilation is interpreted as if the presence of exocyclic double
bonds were of stronger influence than the presence of chiral centers to
reduce the probability of a matching InChi by both generators.
</p>
</div>
</div>
</div>

<div id="outline-container-org76a35eb" class="outline-2">
<h2 id="org76a35eb"><span class="section-number-2">3.</span> Test run (n = 5k), OpenBabel</h2>
<div class="outline-text-2" id="text-3">
<p>
This test departed from a random library of 5000 molecules deposit in file
<code>Random_Molecules_5k.dwar</code>.  The data were processed as in the previous test
with 1k of molecules.
</p>

<table id="org1916990" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">molecule type</th>
<th scope="col" class="org-right">InChi (match)</th>
<th scope="col" class="org-right">InChi (no match)</th>
<th scope="col" class="org-right">sum</th>
<th scope="col" class="org-right">rel. correct</th>
</tr>

<tr>
<th scope="col" class="org-left">(stereo, EZ)</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">[in percent]</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">0 0</td>
<td class="org-right">1846</td>
<td class="org-right">0</td>
<td class="org-right">1846</td>
<td class="org-right">100.00</td>
</tr>

<tr>
<td class="org-left">0 1</td>
<td class="org-right">87</td>
<td class="org-right">465</td>
<td class="org-right">552</td>
<td class="org-right">15.76</td>
</tr>

<tr>
<td class="org-left">0 2</td>
<td class="org-right">0</td>
<td class="org-right">158</td>
<td class="org-right">158</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">0 3</td>
<td class="org-right">0</td>
<td class="org-right">30</td>
<td class="org-right">30</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">0 4</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">3</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">0 5</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">1 0</td>
<td class="org-right">867</td>
<td class="org-right">61</td>
<td class="org-right">928</td>
<td class="org-right">93.43</td>
</tr>

<tr>
<td class="org-left">1 1</td>
<td class="org-right">65</td>
<td class="org-right">258</td>
<td class="org-right">323</td>
<td class="org-right">20.12</td>
</tr>

<tr>
<td class="org-left">1 2</td>
<td class="org-right">0</td>
<td class="org-right">88</td>
<td class="org-right">88</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">1 3</td>
<td class="org-right">0</td>
<td class="org-right">20</td>
<td class="org-right">20</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">1 4</td>
<td class="org-right">0</td>
<td class="org-right">7</td>
<td class="org-right">7</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">2 0</td>
<td class="org-right">362</td>
<td class="org-right">134</td>
<td class="org-right">496</td>
<td class="org-right">72.98</td>
</tr>

<tr>
<td class="org-left">2 1</td>
<td class="org-right">20</td>
<td class="org-right">128</td>
<td class="org-right">148</td>
<td class="org-right">13.51</td>
</tr>

<tr>
<td class="org-left">2 2</td>
<td class="org-right">1</td>
<td class="org-right">24</td>
<td class="org-right">25</td>
<td class="org-right">4.00</td>
</tr>

<tr>
<td class="org-left">2 3</td>
<td class="org-right">0</td>
<td class="org-right">9</td>
<td class="org-right">9</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">2 4</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">3 0</td>
<td class="org-right">104</td>
<td class="org-right">70</td>
<td class="org-right">174</td>
<td class="org-right">59.77</td>
</tr>

<tr>
<td class="org-left">3 1</td>
<td class="org-right">7</td>
<td class="org-right">42</td>
<td class="org-right">49</td>
<td class="org-right">14.29</td>
</tr>

<tr>
<td class="org-left">3 2</td>
<td class="org-right">1</td>
<td class="org-right">7</td>
<td class="org-right">8</td>
<td class="org-right">12.50</td>
</tr>

<tr>
<td class="org-left">3 3</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">3 4</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">4 0</td>
<td class="org-right">17</td>
<td class="org-right">48</td>
<td class="org-right">65</td>
<td class="org-right">26.15</td>
</tr>

<tr>
<td class="org-left">4 1</td>
<td class="org-right">0</td>
<td class="org-right">19</td>
<td class="org-right">19</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">4 2</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">3</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">4 3</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">5 0</td>
<td class="org-right">2</td>
<td class="org-right">25</td>
<td class="org-right">27</td>
<td class="org-right">7.41</td>
</tr>

<tr>
<td class="org-left">5 1</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">4</td>
<td class="org-right">50.00</td>
</tr>

<tr>
<td class="org-left">5 2</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">6 0</td>
<td class="org-right">0</td>
<td class="org-right">6</td>
<td class="org-right">6</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">6 1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">7 1</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">8 0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">11 1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
</table>

<p>
The InChi assigned by DataWarrior and OpenBabel match each other for all of
1864 molecules lacking a stereogenic center and exocyclic double bond.  For
molecules belonging to any other class, the propability that the two
generators assign different InChi (and consequently, a different InChiKey)
is considerably larger.
</p>
</div>
</div>

<div id="outline-container-org7934c20" class="outline-2">
<h2 id="org7934c20"><span class="section-number-2">4.</span> Test run, (n = 1k), RDKit</h2>
<div class="outline-text-2" id="text-4">
<p>
For the purpose of comparison, the scrutiny was repeated with the currently
available version of RDKit (2021.03.5) packaged by Miniconda.  This approach
was elected because this one is multiple releases ahead of the latest version
(2020.09.5) currently packaged for Linux Debian 12/bookworm (branch testing).
The approach aims to follow closely the previous analysis with OpenBabel.
</p>

<p>
The same library, the same .sdf generated by DW about 1k drug like molecules
was read by script <code>rdkit_inchi.py</code> to assign by RDKit SMILES, InChI, and
InChIKey to yield intermediate file <code>RDKit_analysis.txt</code>.  The content of the
later was pasted (including the header line) into DW.  DW converted RDKit's
SMILES into structures.  Macro <code>rd_dw_check.dwam</code> was used to let DW assign
SMILES, InChI, and InChiKey; the comparison of the strings equally was driven
by this macro.  To retain interaction with the results (e. g., DW's sliders)
results were saved in file <code>Random_Molecules_1000_check_rd.dwar</code>.
</p>

<p>
The content was exported into file <code>Random_Molecules_1000_check_rd.txt</code>.  From
branch OpenBabel, script <code>table_stat.py</code> was used again to yield a summary,
file <code>frequency_list.txt</code>.
</p>

<table id="org19ee696" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">molecule type</th>
<th scope="col" class="org-right">InChi (match)</th>
<th scope="col" class="org-right">InChi (no match)</th>
<th scope="col" class="org-right">sum</th>
<th scope="col" class="org-right">rel. correct</th>
</tr>

<tr>
<th scope="col" class="org-left">(stereo, EZ)</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">[in percent]</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">0 0</td>
<td class="org-right">341</td>
<td class="org-right">74</td>
<td class="org-right">415</td>
<td class="org-right">82.17</td>
</tr>

<tr>
<td class="org-left">0 1</td>
<td class="org-right">25</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">100.00</td>
</tr>

<tr>
<td class="org-left">0 2</td>
<td class="org-right">1</td>
<td class="org-right">37</td>
<td class="org-right">38</td>
<td class="org-right">2.63</td>
</tr>

<tr>
<td class="org-left">0 3</td>
<td class="org-right">0</td>
<td class="org-right">6</td>
<td class="org-right">6</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">0 4</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">1 1</td>
<td class="org-right">190</td>
<td class="org-right">15</td>
<td class="org-right">205</td>
<td class="org-right">92.68</td>
</tr>

<tr>
<td class="org-left">1 2</td>
<td class="org-right">15</td>
<td class="org-right">54</td>
<td class="org-right">69</td>
<td class="org-right">21.74</td>
</tr>

<tr>
<td class="org-left">1 3</td>
<td class="org-right">0</td>
<td class="org-right">21</td>
<td class="org-right">21</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">1 4</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">3</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">1 5</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">2 2</td>
<td class="org-right">64</td>
<td class="org-right">32</td>
<td class="org-right">96</td>
<td class="org-right">66.67</td>
</tr>

<tr>
<td class="org-left">2 3</td>
<td class="org-right">4</td>
<td class="org-right">32</td>
<td class="org-right">36</td>
<td class="org-right">11.11</td>
</tr>

<tr>
<td class="org-left">2 4</td>
<td class="org-right">0</td>
<td class="org-right">4</td>
<td class="org-right">4</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">2 5</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">3 3</td>
<td class="org-right">18</td>
<td class="org-right">20</td>
<td class="org-right">38</td>
<td class="org-right">47.37</td>
</tr>

<tr>
<td class="org-left">3 4</td>
<td class="org-right">1</td>
<td class="org-right">7</td>
<td class="org-right">8</td>
<td class="org-right">12.50</td>
</tr>

<tr>
<td class="org-left">3 5</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">4 4</td>
<td class="org-right">6</td>
<td class="org-right">11</td>
<td class="org-right">17</td>
<td class="org-right">35.29</td>
</tr>

<tr>
<td class="org-left">4 5</td>
<td class="org-right">0</td>
<td class="org-right">6</td>
<td class="org-right">6</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">5 5</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">33.33</td>
</tr>

<tr>
<td class="org-left">5 6</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">6 7</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">7 7</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
</table>

<p>
It is noteworthy that this scrutiny does not support an earlier, perhaps
rather implicit assumption that InChI by both generators would match each
other in absence of stereogenic centers and E/Z double bonds.
</p>
</div>
</div>


<div id="outline-container-orge6f15a7" class="outline-2">
<h2 id="orge6f15a7"><span class="section-number-2">5.</span> Test run, (n = 5k), RDKit</h2>
<div class="outline-text-2" id="text-5">
<p>
The library of 5k drug like molecules, submitted to the scrutiny as .sdf by
RDKit.
</p>

<table id="orgf133573" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">molecule type</th>
<th scope="col" class="org-right">InChi (match)</th>
<th scope="col" class="org-right">InChi (no match)</th>
<th scope="col" class="org-right">sum</th>
<th scope="col" class="org-right">rel. correct</th>
</tr>

<tr>
<th scope="col" class="org-left">(stereo, EZ)</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">[in percent]</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">0 0</td>
<td class="org-right">1844</td>
<td class="org-right">2</td>
<td class="org-right">1846</td>
<td class="org-right">99.89</td>
</tr>

<tr>
<td class="org-left">0 1</td>
<td class="org-right">125</td>
<td class="org-right">427</td>
<td class="org-right">552</td>
<td class="org-right">22.64</td>
</tr>

<tr>
<td class="org-left">0 2</td>
<td class="org-right">0</td>
<td class="org-right">158</td>
<td class="org-right">158</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">0 3</td>
<td class="org-right">0</td>
<td class="org-right">29</td>
<td class="org-right">29</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">0 4</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">3</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">0 5</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">3</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">1 1</td>
<td class="org-right">867</td>
<td class="org-right">61</td>
<td class="org-right">928</td>
<td class="org-right">93.43</td>
</tr>

<tr>
<td class="org-left">1 2</td>
<td class="org-right">82</td>
<td class="org-right">241</td>
<td class="org-right">323</td>
<td class="org-right">25.39</td>
</tr>

<tr>
<td class="org-left">1 3</td>
<td class="org-right">0</td>
<td class="org-right">88</td>
<td class="org-right">88</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">1 4</td>
<td class="org-right">0</td>
<td class="org-right">21</td>
<td class="org-right">21</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">1 5</td>
<td class="org-right">0</td>
<td class="org-right">6</td>
<td class="org-right">6</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">2 2</td>
<td class="org-right">362</td>
<td class="org-right">133</td>
<td class="org-right">495</td>
<td class="org-right">73.13</td>
</tr>

<tr>
<td class="org-left">2 3</td>
<td class="org-right">27</td>
<td class="org-right">121</td>
<td class="org-right">148</td>
<td class="org-right">18.24</td>
</tr>

<tr>
<td class="org-left">2 4</td>
<td class="org-right">2</td>
<td class="org-right">24</td>
<td class="org-right">26</td>
<td class="org-right">7.69</td>
</tr>

<tr>
<td class="org-left">2 5</td>
<td class="org-right">0</td>
<td class="org-right">8</td>
<td class="org-right">8</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">2 6</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">3 3</td>
<td class="org-right">104</td>
<td class="org-right">71</td>
<td class="org-right">175</td>
<td class="org-right">59.43</td>
</tr>

<tr>
<td class="org-left">3 4</td>
<td class="org-right">8</td>
<td class="org-right">40</td>
<td class="org-right">48</td>
<td class="org-right">16.67</td>
</tr>

<tr>
<td class="org-left">3 5</td>
<td class="org-right">1</td>
<td class="org-right">7</td>
<td class="org-right">8</td>
<td class="org-right">12.50</td>
</tr>

<tr>
<td class="org-left">3 6</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">3 7</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">4 4</td>
<td class="org-right">17</td>
<td class="org-right">48</td>
<td class="org-right">65</td>
<td class="org-right">26.15</td>
</tr>

<tr>
<td class="org-left">4 5</td>
<td class="org-right">1</td>
<td class="org-right">18</td>
<td class="org-right">19</td>
<td class="org-right">5.26</td>
</tr>

<tr>
<td class="org-left">4 6</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">3</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">4 7</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">5 5</td>
<td class="org-right">2</td>
<td class="org-right">25</td>
<td class="org-right">27</td>
<td class="org-right">7.41</td>
</tr>

<tr>
<td class="org-left">5 6</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">4</td>
<td class="org-right">50.00</td>
</tr>

<tr>
<td class="org-left">5 7</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">6 6</td>
<td class="org-right">0</td>
<td class="org-right">6</td>
<td class="org-right">6</td>
<td class="org-right">0.00</td>
</tr>

<tr>
<td class="org-left">6 7</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">7 8</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">8 8</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">11 10</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0.00</td>
</tr>
</tbody>
</table>

<p>
In this scrutiny, the ratio of identical InChI strings about "simple
molecules" (no chiral centre, no E/Z double bond) generated by two generators
over the total of all molecules submitted is higher than in the earlier run (n
= 1k).
</p>
</div>
</div>

<div id="outline-container-orgfa8ad6e" class="outline-2">
<h2 id="orgfa8ad6e"><span class="section-number-2">6.</span> Single molecule</h2>
<div class="outline-text-2" id="text-6">
<p>
In a pristine instance of DW, one early entry of the set of 1000 molecules
known to be assinged different InChi by OpenBabel and DataWarrior is entered
with the sketcher (file <code>single.dwar</code>).  It is a compound with one stereogenic
center only (assigned as <i>S</i>) for which DW is again queried to assign an InChi
(which is
InChI=1S/C14H12O9/c1-2-6(17)23-13-8-7(4(15)3-5(16)10(8)18)11(19)9(12(13)20)14(21)22/h3,13,15-16,18,20H,2H2,1H3,(H,21,22)/t13-/m1/s1)
</p>

<p>
The InChi is copy-pasted into the mask of the Chemical Identity Resolver of
NIH' Cactus server (<a href="https://cactus.nci.nih.gov/chemical/structure">https://cactus.nci.nih.gov/chemical/structure</a>). The visual
representation however plots the enantiomer (explicitly assigned <i>R</i>). (URL
assigned: <a href="https://cactus.nci.nih.gov/chemical/structure/InChI=1S/C14H12O9/c1-2-6(17)23-13-8-7(4(15)3-5(16)10(8)18)11(19)9(12(13)20)14(21)22/h3,13,15-16,18,20H,2H2,1H3,(H,21,22)/t13-/m1/s1/image">https://cactus.nci.nih.gov/chemical/structure/InChI=1S/C14H12O9/c1-2-6(17)23-13-8-7(4(15)3-5(16)10(8)18)11(19)9(12(13)20)14(21)22/h3,13,15-16,18,20H,2H2,1H3,(H,21,22)/t13-/m1/s1/image</a>)
</p>
</div>
</div>


<div id="outline-container-orge780ba7" class="outline-2">
<h2 id="orge780ba7"><span class="section-number-2">7.</span> Cross-check InChI trust reference</h2>
<div class="outline-text-2" id="text-7">
<p>
For the assignment of molecular structures encoded as a <code>.sdf</code>, the InChI
trust distributes the reference implemention for the assignment of InChI and
InChIKeys as a compiled executable, e.g., for Linux.  Both test sets of 1k and
5k molecules were submitted to this assignment.
</p>

<table id="org634b76e" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> Difference analysis for the assignments by OpenBabel, RDKit, DataWarrior <i>vs.</i> InChI; 1k set.</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right"><code>diff_stereo_ob_rd</code></th>
<th scope="col" class="org-right"><code>diff_ez_ob_rd</code></th>
<th scope="col" class="org-right"><code>diff_structure_ob_rd</code></th>
<th scope="col" class="org-right"><code>inchi_ob_vs_inchi</code></th>
<th scope="col" class="org-right"><code>inchi_rd_vs_inchi</code></th>
<th scope="col" class="org-right"><code>inchi_dw_vs_inchi</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">count (match):</td>
<td class="org-right">999</td>
<td class="org-right">486</td>
<td class="org-right">981</td>
<td class="org-right">983</td>
<td class="org-right">1000</td>
<td class="org-right">666</td>
</tr>

<tr>
<td class="org-left">count (differ):</td>
<td class="org-right">1</td>
<td class="org-right">514</td>
<td class="org-right">19</td>
<td class="org-right">17</td>
<td class="org-right">0</td>
<td class="org-right">334</td>
</tr>

<tr>
<td class="org-left">sum (match+differ):</td>
<td class="org-right">1000</td>
<td class="org-right">1000</td>
<td class="org-right">1000</td>
<td class="org-right">1000</td>
<td class="org-right">1000</td>
<td class="org-right">1000</td>
</tr>

<tr>
<td class="org-left">difference [%]</td>
<td class="org-right">0.10</td>
<td class="org-right">51.40</td>
<td class="org-right">1.90</td>
<td class="org-right">1.70</td>
<td class="org-right">0.00</td>
<td class="org-right">33.40</td>
</tr>
</tbody>
</table>


<table id="org6c647b5" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 2:</span> Difference analysis for the assignments by OpenBabel, RDKit, DataWarrior <i>vs.</i> InChI; 5k set.</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right"><code>diff_stereo_ob_rd</code></th>
<th scope="col" class="org-right"><code>diff_ez_ob_rd</code></th>
<th scope="col" class="org-right"><code>diff_structure_ob_rd</code></th>
<th scope="col" class="org-right"><code>inchi_ob_vs_inchi</code></th>
<th scope="col" class="org-right"><code>inchi_rd_vs_inchi</code></th>
<th scope="col" class="org-right"><code>inchi_dw_vs_inchi</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">count (match):</td>
<td class="org-right">4999</td>
<td class="org-right">2591</td>
<td class="org-right">4861</td>
<td class="org-right">4866</td>
<td class="org-right">4998</td>
<td class="org-right">3444</td>
</tr>

<tr>
<td class="org-left">count (differ):</td>
<td class="org-right">1</td>
<td class="org-right">2409</td>
<td class="org-right">139</td>
<td class="org-right">134</td>
<td class="org-right">2</td>
<td class="org-right">1556</td>
</tr>

<tr>
<td class="org-left">sum (match+differ):</td>
<td class="org-right">5000</td>
<td class="org-right">5000</td>
<td class="org-right">5000</td>
<td class="org-right">5000</td>
<td class="org-right">5000</td>
<td class="org-right">5000</td>
</tr>

<tr>
<td class="org-left">difference [%]</td>
<td class="org-right">0.02</td>
<td class="org-right">48.18</td>
<td class="org-right">2.78</td>
<td class="org-right">2.68</td>
<td class="org-right">0.04</td>
<td class="org-right">31.12</td>
</tr>
</tbody>
</table>

<p>
Lessons learnt:
</p>
<ul class="org-ul">
<li>Possibly, the moderator script for RDKit does not identify between well
enough between double bonds not attached to/included in a cyclic system.</li>
<li>Either OpenBabel/RDKit interpret <code>.sdf</code> differently, or the SMILES assigned
by them differs such that DataWarrior's structure codes occasionally change.
This may, but need not be relevant how DataWarrior perceives the structures
after importing their SMILES string in comparison to DataWarrior's direct
import of .sdf files.</li>
<li>Assuming the implementation by the InChI trust as reference (1.06, december
2020), about one in three structures was assigned a different InChI by
DataWarrior (development version, Mac/Linux, fetched September 7th).  The
differences drop by about a factor of 10 using OpenBabel (3.1.1, 134 out of
5k entries with different assigment), and again by a factor of about 50
using the current version of RDKit (2021.03.5, 2 out of 5k entries with
different assignment).</li>
</ul>
</div>
</div>

<div id="outline-container-orgc16b2b3" class="outline-2">
<h2 id="orgc16b2b3"><span class="section-number-2">8.</span> Cross-check with the InChI trust reference, b</h2>
<div class="outline-text-2" id="text-8">
<p>
Based on commit <code>fa3b7a4</code> on Monday afternoon, 2021-09-20, Thomas Sander
released a Linux development version of DW correcting most of the problems
about the assignment of InChI and InChIKeys faced earlier.
</p>

<p>
The same sets of 1k and 5k drug-like molecules were submitted to the
assignment of InChI and InChIKey by DataWarrior.  These were compared against
the reference executable for Linux, as distributed by the InChI trust (version
1.06, december 2020).  In comparison to DataWarrior as met on September 7, the
improvement is substantial; the rate of differences is about one order of
magnitude below the one seen for the analogue comparison between RDKit against
the InChI trust reference:
</p>

<table id="orgb2a2ea0" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 3:</span> Difference count for InChI and InChIKey assigned by DataWarrior vs. InChI trust, 1k set.</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right"><code>diff_inchi_dw_inchi</code></th>
<th scope="col" class="org-right"><code>inchikey_dw_vs_inchi</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">count (match):</td>
<td class="org-right">998</td>
<td class="org-right">998</td>
</tr>

<tr>
<td class="org-left">count (differ):</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-left">sum (match+differ):</td>
<td class="org-right">1000</td>
<td class="org-right">1000</td>
</tr>

<tr>
<td class="org-left">difference [\%]</td>
<td class="org-right">0.20</td>
<td class="org-right">0.20</td>
</tr>
</tbody>
</table>

<table id="org0b1345b" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 4:</span> Difference count for InChI and InChIKey assigned by DataWarrior vs. InChI trust, 5k set.</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right"><code>diff_inchi_dwb_inchi</code></th>
<th scope="col" class="org-right"><code>inchikey_dw_vs_inchi</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">count (match):</td>
<td class="org-right">4989</td>
<td class="org-right">4989</td>
</tr>

<tr>
<td class="org-left">count (differ):</td>
<td class="org-right">11</td>
<td class="org-right">11</td>
</tr>

<tr>
<td class="org-left">sum (match+differ):</td>
<td class="org-right">5000</td>
<td class="org-right">5000</td>
</tr>

<tr>
<td class="org-left">difference [\%]</td>
<td class="org-right">0.22</td>
<td class="org-right">0.22</td>
</tr>
</tbody>
</table>

<p>
As already recognized by Thomas, the (E)/(Z) configuration of oximes still
represents a potential pitfall for the assignment of InChI.  This is going to
be a different case.
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: norwid</p>
<p class="date">Created: 2021-09-20 Mon 16:22</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
